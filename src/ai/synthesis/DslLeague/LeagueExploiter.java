/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ai.synthesis.DslLeague;

import ai.synthesis.grammar.dslTree.interfacesDSL.iDSL;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

/**
 *
 * @author rubens
 */
public class LeagueExploiter extends PlayerDSL{

    public LeagueExploiter(Payoff payoff, iDSL agent) {
        super(payoff, agent);
    }

    @Override
    public PlayerDSL get_match() {
        List<PlayerDSL> historical = new ArrayList<>();
        for (PlayerDSL player : payoff.getPlayers()) {
            if(player instanceof HistoricalDSL){
                historical.add(player);
            }
        }
        
        List<Double> win_rates = payoff.getItem(this, historical);
        return getRandomChoice(historical, win_rates, "linear_capped");
    }

    @Override
    public boolean ready_to_checkpoint() {
        List<PlayerDSL> historical = new ArrayList<>();
        for (PlayerDSL player : payoff.getPlayers()) {
            if(player instanceof HistoricalDSL){
                historical.add(player);
            }
        }
        
        List<Double> win_rates = payoff.getItem(this, historical);
        return (Collections.min(win_rates) > 0.7);
    }
    
}
